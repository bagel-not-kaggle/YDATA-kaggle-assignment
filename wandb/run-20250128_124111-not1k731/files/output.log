[32m[I 2025-01-28 12:41:13,124][0m A new study created in memory with name: no-name-032d137c-0c26-4fc7-99ce-2698c3af6512[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 12:42:52,679][0m Trial 0 finished with value: 0.14513302863895913 and parameters: {'depth': 3, 'learning_rate': 0.13252254135270314, 'l2_leaf_reg': 30.07436865515731, 'random_strength': 0.14553272625310706, 'grow_policy': 'SymmetricTree', 'bootstrap_type': 'MVS'}. Best is trial 0 with value: 0.14513302863895913.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 12:44:26,462][0m Trial 1 finished with value: 0.1437252485846751 and parameters: {'depth': 3, 'learning_rate': 0.10407605350827125, 'l2_leaf_reg': 33.827006745623024, 'random_strength': 0.5468320593786331, 'grow_policy': 'Depthwise', 'bootstrap_type': 'Bayesian', 'bagging_temperature': 0.1914643920080113, 'min_data_in_leaf': 5}. Best is trial 0 with value: 0.14513302863895913.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 12:45:51,908][0m Trial 2 finished with value: 0.1438007051913694 and parameters: {'depth': 4, 'learning_rate': 0.0993207848662435, 'l2_leaf_reg': 27.60634964952918, 'random_strength': 1.0020135357041375, 'grow_policy': 'Depthwise', 'bootstrap_type': 'Bayesian', 'bagging_temperature': 0.2290844110406287, 'min_data_in_leaf': 5}. Best is trial 0 with value: 0.14513302863895913.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 12:46:36,148][0m Trial 3 finished with value: 0.14316982279251395 and parameters: {'depth': 4, 'learning_rate': 0.11098955195840549, 'l2_leaf_reg': 20.795024188273473, 'random_strength': 0.11039599625925411, 'grow_policy': 'SymmetricTree', 'bootstrap_type': 'Bernoulli', 'subsample': 0.7268727450411712}. Best is trial 0 with value: 0.14513302863895913.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 12:47:17,729][0m Trial 4 finished with value: 0.142487302153192 and parameters: {'depth': 5, 'learning_rate': 0.13234875299875024, 'l2_leaf_reg': 20.545816424026604, 'random_strength': 0.3669178999930244, 'grow_policy': 'SymmetricTree', 'bootstrap_type': 'Bayesian', 'bagging_temperature': 0.21710096623835692}. Best is trial 0 with value: 0.14513302863895913.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 12:48:03,571][0m Trial 5 finished with value: 0.14373154000252458 and parameters: {'depth': 5, 'learning_rate': 0.09431975548783293, 'l2_leaf_reg': 35.348237177298955, 'random_strength': 0.3378609745113321, 'grow_policy': 'SymmetricTree', 'bootstrap_type': 'MVS'}. Best is trial 0 with value: 0.14513302863895913.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 12:49:52,457][0m Trial 6 finished with value: 0.1449831527498795 and parameters: {'depth': 5, 'learning_rate': 0.08678979034552307, 'l2_leaf_reg': 32.565887209288874, 'random_strength': 0.6851496067645159, 'grow_policy': 'SymmetricTree', 'bootstrap_type': 'MVS'}. Best is trial 0 with value: 0.14513302863895913.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 12:51:45,090][0m Trial 7 finished with value: 0.14263524741833028 and parameters: {'depth': 5, 'learning_rate': 0.10708492727445725, 'l2_leaf_reg': 37.302493233325386, 'random_strength': 0.5478841546930138, 'grow_policy': 'SymmetricTree', 'bootstrap_type': 'MVS'}. Best is trial 0 with value: 0.14513302863895913.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 12:54:04,043][0m Trial 8 finished with value: 0.14392868977857987 and parameters: {'depth': 3, 'learning_rate': 0.08224993204616272, 'l2_leaf_reg': 25.812433250963178, 'random_strength': 1.373041024901029, 'grow_policy': 'Depthwise', 'bootstrap_type': 'Bernoulli', 'min_data_in_leaf': 7}. Best is trial 0 with value: 0.14513302863895913.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 12:56:38,698][0m Trial 9 finished with value: 0.14541913337393125 and parameters: {'depth': 3, 'learning_rate': 0.11997296902162494, 'l2_leaf_reg': 15.580266301058613, 'random_strength': 0.47923923619905606, 'grow_policy': 'SymmetricTree', 'bootstrap_type': 'Bayesian', 'bagging_temperature': 0.39734749582788975}. Best is trial 9 with value: 0.14541913337393125.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 12:58:44,274][0m Trial 10 finished with value: 0.1444239673482715 and parameters: {'depth': 3, 'learning_rate': 0.14729434319674517, 'l2_leaf_reg': 15.277589392077168, 'random_strength': 1.010949664244054, 'grow_policy': 'Depthwise', 'bootstrap_type': 'Bayesian', 'bagging_temperature': 0.6910637896902524, 'min_data_in_leaf': 1}. Best is trial 9 with value: 0.14541913337393125.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 13:00:34,581][0m Trial 11 finished with value: 0.14536733077694947 and parameters: {'depth': 3, 'learning_rate': 0.12384252077396701, 'l2_leaf_reg': 28.422379145318903, 'random_strength': 0.12989683757149562, 'grow_policy': 'SymmetricTree', 'bootstrap_type': 'MVS'}. Best is trial 9 with value: 0.14541913337393125.[0m
C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py:17: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  if df[col].dtype == 'object' or pd.api.types.is_categorical_dtype(df[col]):
[32m[I 2025-01-28 13:02:29,587][0m Trial 12 finished with value: 0.14529133574235273 and parameters: {'depth': 4, 'learning_rate': 0.12489724602199073, 'l2_leaf_reg': 23.757882111540397, 'random_strength': 0.32282234439479596, 'grow_policy': 'SymmetricTree', 'bootstrap_type': 'MVS'}. Best is trial 9 with value: 0.14541913337393125.[0m
[33m[W 2025-01-28 13:03:41,479][0m Trial 13 failed with parameters: {'depth': 3, 'learning_rate': 0.12116368238141974, 'l2_leaf_reg': 15.722208700793853, 'random_strength': 0.816944726756351, 'grow_policy': 'SymmetricTree', 'bootstrap_type': 'Bayesian', 'bagging_temperature': 0.5218768489983225} because of the following error: KeyboardInterrupt('').[0m
Traceback (most recent call last):
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\optuna\study\_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\train.py", line 87, in objective
    model.fit(
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\catboost\core.py", line 5245, in fit
    self._fit(X, y, cat_features, text_features, embedding_features, None, graph, sample_weight, None, None, None, None, baseline, use_best_model,
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\catboost\core.py", line 2410, in _fit
    self._train(
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\catboost\core.py", line 1790, in _train
    self._object._train(train_pool, test_pool, params, allow_clear_pool, init_model._object if init_model else None)
  File "_catboost.pyx", line 5017, in _catboost._CatBoost._train
  File "_catboost.pyx", line 5066, in _catboost._CatBoost._train
KeyboardInterrupt
[33m[W 2025-01-28 13:03:41,479][0m Trial 13 failed with value None.[0m
13:03:41.496 | [38;5;160mERROR[0m   | Task run 'tune_hyperparameters-4ca' - Crash detected! Execution was aborted by an interrupt signal.
13:03:41.499 | [38;5;160mERROR[0m   | Task run 'tune_hyperparameters-4ca' - Finished in state [91mCrashed[0m('Execution was aborted by an interrupt signal.')
13:03:41.502 | [38;5;160mERROR[0m   | Flow run[35m 'mottled-partridge'[0m - Crash detected! Execution was aborted by an interrupt signal.
13:03:41.872 | [38;5;160mERROR[0m   | Flow run[35m 'mottled-partridge'[0m - Finished in state [91mCrashed[0m('Execution was aborted by an interrupt signal.')
Traceback (most recent call last):
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py", line 107, in <module>
    tune_and_train_pipeline(
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\prefect\flows.py", line 1392, in __call__
    return run_flow(
           ^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\prefect\flow_engine.py", line 1511, in run_flow
    ret_val = run_flow_sync(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\prefect\flow_engine.py", line 1354, in run_flow_sync
    engine.call_flow_fn()
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\prefect\flow_engine.py", line 766, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\prefect\utilities\callables.py", line 208, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py", line 92, in tune_and_train_pipeline
    best_params = tune_hyperparameters(base_trainer, folds_dir, n_trials, run_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\prefect\tasks.py", line 1035, in __call__
    return run_task(
           ^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\prefect\task_engine.py", line 1576, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\prefect\task_engine.py", line 1387, in run_task_sync
    engine.call_task_fn(txn)
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\prefect\task_engine.py", line 828, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\prefect\utilities\callables.py", line 208, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\tasks_wandb.py", line 42, in tune_hyperparameters
    return trainer.hyperparameter_tuning(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\train.py", line 130, in hyperparameter_tuning
    study.optimize(objective, n_trials=n_trials)
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\optuna\study\study.py", line 475, in optimize
    _optimize(
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\optuna\study\_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\optuna\study\_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\optuna\study\_optimize.py", line 248, in _run_trial
    raise func_err
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\optuna\study\_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\train.py", line 87, in objective
    model.fit(
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\catboost\core.py", line 5245, in fit
    self._fit(X, y, cat_features, text_features, embedding_features, None, graph, sample_weight, None, None, None, None, baseline, use_best_model,
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\catboost\core.py", line 2410, in _fit
    self._train(
  File "C:\Users\maorb\Classes\Classical_ML\YDATA-kaggle-assignment\venv\Lib\site-packages\catboost\core.py", line 1790, in _train
    self._object._train(train_pool, test_pool, params, allow_clear_pool, init_model._object if init_model else None)
  File "_catboost.pyx", line 5017, in _catboost._CatBoost._train
  File "_catboost.pyx", line 5066, in _catboost._CatBoost._train
KeyboardInterrupt
